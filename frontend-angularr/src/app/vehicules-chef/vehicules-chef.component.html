    <!-- ‚îÄ‚îÄ HERO ‚îÄ‚îÄ -->
    <div class="hero">
    <div class="hero-inner">
        <h2>Gestion des <em>V√©hicules</em></h2>
        <p>Suivi des v√©hicules du parc automobile</p>
    </div>
    </div>

    <!-- ‚îÄ‚îÄ STAT PILLS ‚îÄ‚îÄ -->
    <div class="stats-row">
    <div class="stat-pill sp-total">
        <div class="stat-icon">üöò</div>
        <div>
        <div class="stat-num">{{ totalVehicules }}</div>
        <div class="stat-lbl">Total V√©hicules</div>
        </div>
    </div>

    <div class="stat-pill sp-dispo">
        <div class="stat-icon">‚úÖ</div>
        <div>
        <div class="stat-num">{{ vehiculesDisponibles }}</div>
        <div class="stat-lbl">Disponibles</div>
        </div>
    </div>

    <div class="stat-pill sp-mission">
        <div class="stat-icon">üìç</div>
        <div>
        <div class="stat-num">{{ missionsEnCours }}</div>
        <div class="stat-lbl">En Mission</div>
        </div>
    </div>

    <div class="stat-pill sp-maint">
        <div class="stat-icon">üîß</div>
        <div>
        <div class="stat-num">{{ vehiculesEnEntretien }}</div>
        <div class="stat-lbl">En Entretien</div>
        </div>
    </div>

    <div class="stat-pill sp-indispo">
        <div class="stat-icon">üö´</div>
        <div>
        <div class="stat-num">{{ vehiculesIndisponibles }}</div>
        <div class="stat-lbl">Indisponible</div>
        </div>
    </div>
    </div>

    <!-- ‚îÄ‚îÄ TABLE CARD ‚îÄ‚îÄ -->
    <div class="table-card">

    <!-- Header -->
    <div class="tc-header">
        <div class="tc-title">
        <div class="gold-dot"></div>
        <h3>Inventaire du Parc</h3>
        <span class="count-badge">{{ filteredVehicules.length }}</span>
        </div>

        <div class="filter-pills">
        <button class="fp" [class.on]="currentFilter === 'ALL'" (click)="filterByEtat('ALL')">Tous</button>
        <button class="fp" [class.on]="currentFilter === 'DISPONIBLE'" (click)="filterByEtat('DISPONIBLE')">Disponibles</button>
        <button class="fp" [class.on]="currentFilter === 'EN_MISSION'" (click)="filterByEtat('EN_MISSION')">En Mission</button>
        <button class="fp" [class.on]="currentFilter === 'EN_ENTRETIEN'" (click)="filterByEtat('EN_ENTRETIEN')">Entretien</button>
        <button class="fp" [class.on]="currentFilter === 'INDISPONIBLE'" (click)="filterByEtat('INDISPONIBLE')">Indisponible</button>
        </div>
    </div>

    <!-- Table -->
    <div style="overflow-x:auto;">
        <table>
        <thead>
            <tr>
            <th scope="col">#</th>
            <th scope="col">Matricule</th>
            <th scope="col">V√©hicule</th>
            <th scope="col">Ann√©e</th>
            <th scope="col">Carburant</th>
            <th scope="col">√âtat</th>
            <th scope="col">Actions</th>
            </tr>
        </thead>

        <tbody>
            <tr *ngFor="let v of filteredVehicules; let i = index">
            <td scope="row"><div class="row-num">{{ i + 1 }}</div></td>
            <td><span class="matricule-tag">{{ v.matricule }}</span></td>
            <td>
                <div class="vehicle-cell">
                <div class="veh-icon-wrap">üöó</div>
                <div class="veh-info">
                    <strong>{{ v.marque }}</strong>
                    <span>{{ v.modele }}</span>
                </div>
                </div>
            </td>
            <td><span class="year-tag">{{ v.annee }}</span></td>
            <td><div class="fuel-cell">{{ v.carburant }}</div></td>
            <td>
                <span class="badge" [ngClass]="{
                'b-dispo': v.etat === 'DISPONIBLE',
                'b-mission': v.etat === 'EN_MISSION',
                'b-entretien': v.etat === 'EN_ENTRETIEN',
                'b-indispo': v.etat === 'INDISPONIBLE'
                }">{{ v.etat }}</span>
            </td>
            <td class="actions">
                <button class="btn-ac btn-consult" (click)="consulterVehicule(v)">Consulter</button>
                <button class="btn-ac btn-affect"[ngClass]="{'btn-disabled': v.etat !== 'DISPONIBLE'}"(click)="verifierDisponibilite(v)">
                    Affecter
                </button>
                <button class="btn-ac btn-maj" (click)="modifierVehicule(v)">Mettre √† jour</button>
            </td>
            </tr>
        </tbody>
        </table>
    </div>

    <!-- Footer -->
    <div class="tc-footer">
        <p>Affichage <strong>1‚Äì{{ filteredVehicules.length }}</strong> sur <strong>{{ totalVehicules }}</strong> v√©hicules</p>
    </div>
    </div>

    <!-- ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ -->
    <div class="footer-bar">
    <p>¬© 2026 <strong>AGIL ENERGY</strong> ¬∑ Syst√®me de Gestion du Parc Automobile</p>
    </div>

    <!-- ‚îÄ‚îÄ MODAL MISE √Ä JOUR √âTAT ‚îÄ‚îÄ -->
    <div  class="modal-overlay-sndp" *ngIf="showModal">
    <canvas id="particles"></canvas>
    <div class="modal-box">
        <div class="modal-header">
        <div class="modal-header-top" style="display:flex; align-items:flex-start; justify-content:space-between; margin-bottom:18px;">
            <div class="header-icon" style="background: #F5C200;">üöó</div>
            <button class="modal-close" (click)="closeModal()" title="Fermer">&times;</button>
        </div>
        <div class="modal-title">Mise √† jour du statut</div>
        <div class="modal-subtitle">Modifier l'√©tat op√©rationnel du v√©hicule</div>
        <div class="vehicle-strip" style="margin-top:16px;" *ngIf="selectedVehicule">
            <div class="vehicle-strip-icon">üèéÔ∏è</div>
            <div class="vehicle-strip-info">
            <strong>{{ selectedVehicule.marque }} {{ selectedVehicule.modele }}</strong>
            <div class="vehicle-strip-mat">‚ñ∏ {{ selectedVehicule.matricule }}</div>
            </div>
        </div>
        </div>

        <div class="modal-body">
        <div class="field-label">Choisir un nouvel √©tat</div>
        <div class="status-grid">
            <label class="status-option s-dispo">
            <input type="radio" name="etat" value="DISPONIBLE" [(ngModel)]="nouvelEtat">
            <div class="status-card">
                <span class="status-emoji">‚úÖ</span>
                <div class="status-text">
                <strong>Disponible</strong>
                <span>Pr√™t √† partir</span>
                </div>
                <div class="check-mark">‚úì</div>
            </div>
            </label>

            <label class="status-option s-mission">
            <input type="radio" name="etat" value="EN_MISSION" [(ngModel)]="nouvelEtat">
            <div class="status-card">
                <span class="status-emoji">üìç</span>
                <div class="status-text">
                <strong>En mission</strong>
                <span>Sur le terrain</span>
                </div>
                <div class="check-mark">‚úì</div>
            </div>
            </label>

            <label class="status-option s-entretien">
            <input type="radio" name="etat" value="EN_ENTRETIEN" [(ngModel)]="nouvelEtat">
            <div class="status-card">
                <span class="status-emoji">üîß</span>
                <div class="status-text">
                <strong>En entretien</strong>
                <span>Maintenance</span>
                </div>
                <div class="check-mark">‚úì</div>
            </div>
            </label>

            <label class="status-option s-indispo">
            <input type="radio" name="etat" value="INDISPONIBLE" [(ngModel)]="nouvelEtat">
            <div class="status-card">
                <span class="status-emoji">üö´</span>
                <div class="status-text">
                <strong>Indisponible</strong>
                <span>Hors service</span>
                </div>
                <div class="check-mark">‚úì</div>
            </div>
            </label>
        </div>
        </div>

        <div class="divider"></div>

        <div class="modal-footer">
        <button class="btn-cancel-m" (click)="closeModal()">Annuler</button>
        <button class="btn-confirm-m" (click)="confirmerMiseAJour()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="20 6 9 17 4 12"/>
            </svg>
            <span>Mettre √† jour</span>
        </button>
        </div>
    </div>
    </div>
    <!--modal consulter-->
 <div class="modal-overlay-sndp" *ngIf="showConsultModal" (click)="closeConsultModal()">
    
    <div class="modal-consult-sndp" (click)="$event.stopPropagation()">

        <div class="modal-header-sndp">
            <div class="header-left-sndp">
                
                <div class="logo-container-sndp">
                    <img src="https://www.babnet.net/images/imgnews/agil.jpg" alt="Logo SNDP" class="logo-custom-sndp">
                </div>

                <div class="header-title-sndp">
                    <span class="label-sndp">SNDP &mdash; Parc Automobile</span>
                    <h2>FICHE V√âHICULE</h2>
                </div>

            </div>

            <div class="header-badge-sndp">
                <div class="badge-dot-sndp"></div>
                {{ selectedVehicule?.etat }}
            </div>
        </div>

        <div class="modal-body-sndp">
            <div class="image-side-sndp">
                <img class="vehicle-img-sndp" 
                    [src]="selectedVehicule?.image" 
                    alt="V√©hicule">
                <div class="img-overlay-label-sndp">
                    <div class="matricule-tag-sndp">{{ selectedVehicule?.matricule }}</div>
                </div>
            </div>

            <div class="info-side-sndp">
                <div class="section-label-sndp">Informations D√©taill√©es</div>
                <div class="info-grid-sndp">
                    <div class="info-row-sndp">
                        <div class="info-key-sndp">üè∑Ô∏è Marque</div>
                        <div class="info-val-sndp">{{ selectedVehicule?.marque }}</div>
                    </div>
                    <div class="info-row-sndp">
                        <div class="info-key-sndp">üöó Mod√®le</div>
                        <div class="info-val-sndp">{{ selectedVehicule?.modele }}</div>
                    </div>
                    <div class="info-row-sndp">
                        <div class="info-key-sndp">üìã Matricule</div>
                        <div class="info-val-sndp" style="color: #F5C800;">{{ selectedVehicule?.matricule }}</div>
                    </div>
                    <div class="info-row-sndp">
                        <div class="info-key-sndp">üìÖ Ann√©e</div>
                        <div class="info-val-sndp">{{ selectedVehicule?.annee }}</div>
                    </div>
                    <div class="info-row-sndp">
                        <div class="info-key-sndp">‚õΩ Carburant</div>
                        <div class="info-val-sndp">
                            <span class="fuel-pill-sndp">{{ selectedVehicule?.carburant }}</span>
                        </div>
                    </div>
                    <div class="info-row-sndp">
                        <div class="info-key-sndp">üìä √âtat</div>
                        <div class="info-val-sndp">
                            <span class="state-badge-sndp">{{ selectedVehicule?.etat }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal-footer-sndp">
            <div class="footer-info-sndp">
                ID V√©hicule &nbsp;<span>#VH-{{selectedVehicule?.annee}}-{{selectedVehicule?.idVehicule}}</span>
            </div>
            <div class="action-btns-sndp">
                <button class="btn-sndp btn-secondary-sndp" (click)="closeConsultModal()">Fermer</button>
            </div>
        </div>
    </div>
</div>

    <!--modal affecter chaufeur-->
        <div class="afx-overlay" *ngIf="showAffecterModal">
    <div class="afx-card">
        
        <div class="afx-header">
        <div class="afx-header-content">
            <img src="https://www.babnet.net/images/imgnews/agil.jpg" class="afx-logo" alt="AGIL">
            <div class="afx-title-group">
            <h3 class="afx-main-title">Affectation Chauffeur</h3>
            <span class="afx-matricule">{{selectedVehicule?.matricule}}</span>
            </div>
        </div>
        <button class="afx-close" (click)="showAffecterModal = false">&times;</button>
        </div>

        <div class="afx-body">
        <p class="afx-hint">S√©lectionnez un conducteur disponible :</p>
        
        <div class="afx-list">
            <div *ngFor="let c of chauffeursFiltres" 
                class="afx-item"
                [class.is-selected]="selectedChauffeurId === c.idChauffeur"
                [class.is-disabled]="c.vehicule"
                (click)="!c.vehicule ? (selectedChauffeurId = c.idChauffeur) : null">
            
            <div class="afx-avatar">{{c.user?.prenom?.[0]}}{{c.user?.nom?.[0]}}</div>
            
            <div class="afx-details">
                <span class="afx-name">{{c.user?.nom}} {{c.user?.prenom}}</span>
                <span class="afx-license">Permis: {{c.typeVehiculePermis}}</span>
            </div>

            <div class="afx-status-box">
                <span [class]="c.vehicule ? 'afx-badge is-busy' : 'afx-badge is-free'">
                {{ c.vehicule ? 'D√©j√† assign√©' : 'Disponible' }}
                </span>
            </div>
            </div>
        </div>
        </div>

        <div class="afx-footer">
        <button class="afx-btn-secondary" (click)="showAffecterModal = false">Annuler</button>
        <button class="afx-btn-primary" 
                [disabled]="!selectedChauffeurId" 
                (click)="confirmerAffectation()">
            Valider l'affectation
        </button>
        </div>
    </div>
    </div>